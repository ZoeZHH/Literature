---
title: "Investigating Impacts of Seedling Removal on Soil and Ground-level Vegetation Respiration (CO~2~ and CH~4~) in a Restored Peatland Ecosystem"
format: docx
editor: visual
author: Hehan (Zoe) Zhang
toc: true
number-sections: true
bibliography: references.yaml
---

# Introduction

## The Carbon Cycle in Peatlands

### Land-atmosphere Exchanges of Carbon Fluxes

@chapin2006 proposed the term net ecosystem carbon balance (NECB) as the overall ecosystem C balance from all sources, including C pathways between terrestrial and atmosphere, terrestrial and aquatic and particulate transport, which represents the net rate of C accumulation in ecosystems. In most peatlands, NECB can be simplified as - NEE/F~CO2~ (net ecosystem exchange, the net CO~2~ flux between terrestrial ecosystems and atmosphere) + F~CH4~ (net CH~4~ flux between terrestrial ecosystems and atmosphere) + F~DOC~ (net dissolved organic carbon) [@strack2013; @dacunha2019]. The land-atmosphere exchange of C fluxes include the two components of NECB in peatlands, F~CO2~ and F~CH4~.

The land-atmosphere exchanges of carbon fluxes in peatlands can be described using the acrotelm-catotelm model (Figure 1). The balance between photosynthesis, respiration and diffusion mainly represents the net F~CO2~ between the bog and the atmosphere. Autotrophic organisms convert CO~2~ from the atmosphere into chemical energy through photosynthesis. CO~2~ is released from ecosystems by Reco and diffusion. Ecosystem respiration (Reco) including above- and below-ground autotrophic and heterotrophic respiration (Ra and Rh, respectively). Both Ra and Rh in bogs involve the consumption of organic matter and oxygen to produce energy, water, and carbon dioxide. The CO~2~ produced by aerobic decomposition and methanotrophy, the oxidation of CH~4~ by methanotrophs, diffused into the atmosphere [@bridgham2013]. The F~CO2~ (NEE) represents the difference between Reco and Gross primary productivity by photosynthesis (GPP) between the bog and atmosphere. Negative NEE values indicate a carbon sink peatland, which takes up more CO~2~ from the atmosphere and accumulates in terrestrial ecosystems.

CH~4~ is made in the saturated zone of peat soils by methanogenic microbes. There are two primary pathways for methanogenesis in wetlands: acetoclastic and hydrogenotrophic methanogenesis [@bridgham2013]. Acetoclastic methanogens utilize acetate as their primary electron acceptor during the methanogenesis process. Hydrogenotrophic methanogens rely on the utilization of hydrogen (H~2~) and CO~2~ as substrates for methanogenesis [@fenchel2012]. Bogs tend to be generally dominated by hydrogenotrophic methanogenesis [@bridgham2013]. F~CH4~ is emitted to the atmosphere through three main pathways: diffusion (driven by CH~4~ concentration gradients from the peat to the atmosphere), ebullition (gas bubbles released from saturated peat), and plants-mediated transport (through aerenchyma, the plants' internal gas-space ventilation system) [@holden2005]. F~CH4~ from peatlands are the net balance of CH~4~ production (methanogenesis) in the saturated zones of the peat and CH~4~ oxidation in the oxic peat layers (methanotrophy) [@bridgham2013; @white2008].

### Biophysical Controls of Ecosystem Respiration and F~CH4~

Peat temperature (Ts), water table depth (WTD)

[@bubier1998]: Ecosystem respiration is closely associated with the surface peat temperatures on daily scales, which could explains 43-74% of the variability in daily ecosystem respiration. Followed by water table depth , could explain another 5-20%. Water table depth controls the depth of the aerobic zone in peat profile, has a stronger correlation than peat temperature on seasonal ecosystem respiration flux. The bog, with lower nutrient availability has lower rates of photosynthesis and respiration

[@frolking2011]: Many studies related an increase in soil temperature with an increase in ecosystem respiration; Water table is known to exert a strong control on CH4 emissions from peatlands. Water table depth determines the extent of the saturated peat, where CH4 is generally produced, and the thickness of the overlying unsaturated portion, where CH4 is generally oxidized (Whalen 2005).

Water table depth (WTD), peat temperature (Ts), peat acidity and vegetation types are key factors influencing CH4 fluxes. Deeper WTDs are generally associated with lower CH4 fluxes due to the shallower CH4 production layer and thicker CH4 oxidation layer [(Lai, 2009; Whalen, 2005)](https://www.zotero.org/google-docs/?kZBeNb). Ts is a significant driver of CH4 flux through its influence on metabolic processes, with methanogenesis most efficient at peat temperatures ranging from 20 to 40 ℃ (Whalen, 2005). The temperature coefficients, known as Q10 values, represent the factor by which a reaction rate increases for every 10℃ rise in temperature. These coefficients are commonly utilized to evaluate how sensitive microbial processes are to fluctuations in temperature. In addition to WTD and Ts, vegetation is a crucial factor in determining CH4 fluxes from peatlands. The presence and type of vegetation influence CH4 production by providing organic substrates like root exudates and plant litter (Bridgham et al., 2013). Aerenchymatous peatland plants with developed deep roots that penetrate anoxic peat, increasing methane production via root exudation and its transport through root pathways (Lai, 2009).

## Techniques for Measuring Carbon Fluxes

### Chamber Methods with Gas Chromatography and Portable Analyzer

## Burns Bog Greenhouse Gas Budget

@lee2017 examined the year-round greenhouse gas budget (16 June 2015 to 15 June 2016) in a center area of BBECA which has been harvested, disturbed and rewetted using eddy covariance technique. The annual Reco in this area is 236±16.4 gCO~2~-Cm^-2^yr^-1^, with higher values during the growing season (\>20 gCO~2~-Cm^-2^month^-1^).The study revealed that T~s,5cm~, WTH and Ta are three controls on Reco. The relationship between Reco and T~s,5cm~ varies with season: it is non-significant in winter, logistic in spring, constant Reco over the early summer, and exponential in fall. Ta is correlated with Reco when Ta \< 16 ℃ and had the similar impact as T~s,5cm.~ The higher WTH in winter suppress the Reco. Similarly, F~CH4~ are higher in the growing season (\>1000 mgCH~4~-Cm^-2^month^-1^) and lower in the non-growing season, leading to an annual CH~4~-C budget was 17±1.0 gCH~4~-Cm^-2^yr^-1^. WTH and Ts are primary controls on FCH4, with WTH positively correlating with FCH4. However, the summer months exhibit higher FCH4 despite lower WTH, likely due to: 1) peat sustaining anaerobic conditions above the water table, and 2) sedges providing an efficient diffusion pathway for FCH4 via plant aerenchyma.

@christen2016 examined summertime greenhouse gas fluxes (June to August 2014) from undisturbed, disturbed and rewetted soils in BBECA. It found the site with lower respiration fluxes experienced the lowest soil temperature and shallowest water table, the site with highest respiration flux had the warmest average soil temperature over the study period.

# Materials and Methods

## Study area (2023/12/12)

## Measurement Sites (2023/12/13)

## Measurement Procedures (2023/12/14-2023/12/15)

### Chamber-Portable Analyzer Measurements of R~eco~ and F~CH4~

Reco and FCH4 were measured using an opaque survey chamber (LI-8200-01S) connected to a laser-based gas analyzer (LI-7810). The LI-7810 Trace Gas Analyzer is a high-precision, laser-based instrument employing Optical Feedback---Cavity-Enhanced Absorption Spectroscopy (OF-CEAS) for measuring gases in the air. It draws air from the chamber into the analyzer through an air inlet. This air then passes through the optical bench and a phase adjuster for flux measurements before being exhausted through the air outlet. The Smart Chamber, LI-8200-01S, is a portable, self-powered survey chamber with a 20-cm diameter. It features an embedded microprocessor and internal storage for real-time flux calculations when connected to the gas analyzer. The flux data can be monitored in real time or stored in the Smart Chamber for later retrieval. Additionally, the Smart Chamber is equipped with a Stevens HydraProbe soil moisture and temperature probe. This probe, placed at approximately 0.05m depth just outside the collar, is used for measuring soil temperature and volumetric water content.

### EC Measurements of Ecosystem CO2 Exchange

### Climate Measurements

# Analysis

## PART1 - Anova

```{r}
library(tidyverse)
setwd("/Users/zoe/desktop/Rplots/Data")
df <- read.csv("growinganalysis.csv", header = TRUE)
df$peat_temp_5cm[df$peat_temp_5cm < -30] <- NA
df$peat_vwc_5cm[df$peat_vwc_5cm < -100] <- NA
df$FCO2_EXP[df$FCO2_EXP < -10 | df$FCO2_EXP > 10] <- NA
df$FCH4_EXP[df$FCH4_EXP < -10 | df$FCH4_EXP > 10] <- NA
df <- filter(df, !grepl("C$", label))
```

```{r}
# Two-way anova analysis for 36 collars average overtime - FCO2 (seedling/ecosystem types)
collar_fluxes <- df %>%
  group_by(label, vegetation_type, trts) %>%
  summarise(FCO2_EXP_avg = mean(FCO2_EXP, na.rm = TRUE), 
            FCH4_EXP_avg = mean(FCH4_EXP, na.rm = TRUE))
print(collar_fluxes)
model_averagecollar_FCO2 <- lm (FCO2_EXP_avg ~ vegetation_type*trts, data = collar_fluxes)
summary(model_averagecollar_FCO2)
# Check for assumptions
collar_fluxes$yhat.1 <- fitted(model_averagecollar_FCO2)
collar_fluxes$resid.1 <- resid(model_averagecollar_FCO2)
collar_fluxes$stdresid.1 <- resid(model_averagecollar_FCO2)/summary(model_averagecollar_FCO2)$sigma
# Independent assumption met because we take the average of the data overtime and no temporal correlation
# Normality assumption
# qqplot
qqnorm(collar_fluxes$stdresid.1, pch=19)
qqline(collar_fluxes$stdresid.1, col=2)
# Histogram
hist(collar_fluxes$stdresid.1, freq = T, breaks = 6, density = 10, xlab = "Residuals", ylab = "Frequency", main = "Histogram of Residuals", col = "green", border = "black")
# Shapiro test
shapiro.test(collar_fluxes$stdresid.1)
# Homogenity assumption
plot(resid.1~yhat.1, data = collar_fluxes, xlab = "Predicted", ylab = "Residuals", main = "Residuals Plot", pch=19)
abline(a=0, b=0, col = "red")
```

```{r}
# Anova test
model_averagecollar_FCO2_anova <- aov(FCO2_EXP_avg ~ vegetation_type + trts + vegetation_type:trts, data = collar_fluxes)
# Summarize the model results
summary(model_averagecollar_FCO2_anova)
```

**`trts`**: p-value of 0.00436 (indicated by **`**`**), suggests that the treatment factor significantly affects the FCO2. No further post-hoc tests conduct because we only has a pair of trts, which anova tests already tell us there's significant differences between them.

```{r}
collar_fluxes <- collar_fluxes[collar_fluxes$label != "LS5", ]
print(collar_fluxes)
model_averagecollar_FCH4 <- lm (log(FCH4_EXP_avg+10) ~ vegetation_type*trts, data = collar_fluxes)
summary(model_averagecollar_FCH4)
# Check for assumptions
collar_fluxes$yhat.2 <- fitted(model_averagecollar_FCH4)
collar_fluxes$resid.2 <- resid(model_averagecollar_FCH4)
collar_fluxes$stdresid.2 <- resid(model_averagecollar_FCH4)/summary(model_averagecollar_FCH4)$sigma
# Independent assumption met because we take the average of the data overtime and no temporal correlation
# Normality assumption
# qqplot
qqnorm(collar_fluxes$stdresid.2, pch=19)
qqline(collar_fluxes$stdresid.2, col=2)
# Histogram
hist(collar_fluxes$stdresid.2, freq = T, breaks = 6, density = 10, xlab = "Residuals", ylab = "Frequency", main = "Histogram of Residuals", col = "green", border = "black")
# Shapiro test
shapiro.test(collar_fluxes$stdresid.2)
# Homogenity assumption
plot(resid.2~yhat.2, data = collar_fluxes, xlab = "Predicted", ylab = "Residuals", main = "Residuals Plot", pch=19)
abline(a=0, b=0, col = "red")
```

This will be problematic, because the equal variance and normality assumption didn't meet, it yields for unreliable anova results.

```{r}
# Anova test
model_averagecollar_FCH4_anova <- aov(FCH4_EXP_avg ~ vegetation_type + trts + vegetation_type:trts, data = collar_fluxes)
# Summarize the model results
summary(model_averagecollar_FCH4_anova)
```

Transform FCH4_EXP_avg to log(FCH4_EXP_avg+10) and perform anova

```{r}
# Anova test
model_averagecollar_FCH4_anova <- aov(log(FCH4_EXP_avg+10) ~ vegetation_type + trts + vegetation_type:trts, data = collar_fluxes)
# Summarize the model results
summary(model_averagecollar_FCH4_anova)
```

Performing two-way ANOVA on the rank-transformed data. Ranking is one of many procedures used to transform data that do not meet the assumptions of normality. However, the equal variance assumption is violated.

```{r}
collar_fluxes <- collar_fluxes[collar_fluxes$label != "LS5", ]
print(collar_fluxes)
model_averagecollar_FCH4 <- lm (rank(FCH4_EXP_avg) ~ vegetation_type*trts, data = collar_fluxes)
summary(model_averagecollar_FCH4)
# Check for assumptions
collar_fluxes$yhat.2 <- fitted(model_averagecollar_FCH4)
collar_fluxes$resid.2 <- resid(model_averagecollar_FCH4)
collar_fluxes$stdresid.2 <- resid(model_averagecollar_FCH4)/summary(model_averagecollar_FCH4)$sigma
# Independent assumption met because we take the average of the data overtime and no temporal correlation
# Normality assumption
# qqplot
qqnorm(collar_fluxes$stdresid.2, pch=19)
qqline(collar_fluxes$stdresid.2, col=2)
# Histogram
hist(collar_fluxes$stdresid.2, freq = T, breaks = 6, density = 10, xlab = "Residuals", ylab = "Frequency", main = "Histogram of Residuals", col = "green", border = "black")
# Shapiro test
shapiro.test(collar_fluxes$stdresid.2)
# Homogenity assumption
plot(resid.2~yhat.2, data = collar_fluxes, xlab = "Predicted", ylab = "Residuals", main = "Residuals Plot", pch=19)
abline(a=0, b=0, col = "red")
```

```{r}
model_averagecollar_FCH4_anova.rnk <- aov(rank(FCH4_EXP_avg) ~ vegetation_type + trts + vegetation_type:trts, data = collar_fluxes)
 # Summarize the model results
summary(model_averagecollar_FCH4_anova.rnk)
```

There's a significant differences between vegetation types.

```{r}
library(emmeans)
emmeans(model_averagecollar_FCH4_anova.rnk, pairwise ~ vegetation_type | trts)
```

There're significant differences between PSW and the other two vegetation types (PSLS/PSTS) in both R and S treatment site; there's no significant differences between PSLS and PSTS.

## PART2 - Q10

Plot raw data for TS_5 vs. FCO2 & TS_5 vs. FCH4 by **treatments**

```{r}
plot_flux_by_month <- function(data, x_var, y_var, y_label) {
  ggplot(data, aes_string(x = x_var, y = y_var, color = "factor(trts)")) +
    geom_point(size = 3, shape = 19) + 
    labs(x = x_var, y = y_label, title = paste("Scatterplot of", y_label, "by Ecosystem Types")) +
    scale_color_discrete(name = "Ecosystem Types") +
    theme_minimal()
}

df1 <- df %>% 
  mutate(month = lubridate::month(date))
er_flux_temp_plot <- plot_flux_by_month(df1, "peat_temp_5cm", "FCO2_EXP", "ER (µmol/m²/s)")
ch4_flux_temp_plot <- plot_flux_by_month(df1, "peat_temp_5cm", "FCH4_EXP", "FCH4 (nmol/m²/s)")
er_flux_vwc_plot <- plot_flux_by_month(df1, "peat_vwc_5cm", "FCO2_EXP", "ER (µmol/m²/s)")
ch4_flux_vwc_plot <- plot_flux_by_month(df1, "peat_vwc_5cm", "FCH4_EXP", "FCH4 (nmol/m²/s)")

er_flux_temp_plot
ch4_flux_temp_plot
er_flux_vwc_plot
ch4_flux_vwc_plot
```

Plot raw data for TS_5 vs. FCO2 & TS_5 vs. FCH4 by **ecosystem types**

```{r}
plot_flux_by_month <- function(data, x_var, y_var, y_label) {
  ggplot(data, aes_string(x = x_var, y = y_var, color = "factor(vegetation_type)")) +
    geom_point(size = 3, shape = 19) + 
    labs(x = x_var, y = y_label, title = paste("Scatterplot of", y_label, "by Ecosystem Types")) +
    scale_color_discrete(name = "Ecosystem Types") +
    theme_minimal()
}

df1 <- df %>% 
  mutate(month = lubridate::month(date))
er_flux_temp_plot <- plot_flux_by_month(df1, "peat_temp_5cm", "FCO2_EXP", "ER (µmol/m²/s)")
ch4_flux_temp_plot <- plot_flux_by_month(df1, "peat_temp_5cm", "FCH4_EXP", "FCH4 (nmol/m²/s)")
er_flux_vwc_plot <- plot_flux_by_month(df1, "peat_vwc_5cm", "FCO2_EXP", "ER (µmol/m²/s)")
ch4_flux_vwc_plot <- plot_flux_by_month(df1, "peat_vwc_5cm", "FCH4_EXP", "FCH4 (nmol/m²/s)")

er_flux_temp_plot
ch4_flux_temp_plot
er_flux_vwc_plot
ch4_flux_vwc_plot
```

```{r}
# Assuming your data frame is named df
df$study_site <- substr(df$label, 1, 2)
print(df)
```

Temperatures sensitivity (Q10) analyses how C fluxes respond to variations in soil temperature. Q10 describes the relative increase in daily Reco or CH4 flux per 10 °C increase in daily soil temperature.

CO2-Step 1: $ln(Reco) = A + b_{Reco}T_{s,5cm}$

CO2-Step 2: $Q10_{Reco} = e^{10b_{R_{eco}}}$

CH4-Step 1: $FCH_4 = ae^{b_{FCH4}T_{s,5cm}}$

CH4-Step 2: $Q10_{FCH4} = e^{10b_{FCH_4}}$

```{r}
exp_model <- function(temp, a, b) {
  a * exp(b * temp)
}
plot_list <- list()

# Loop over each study site to fit model and plot
for (ss in unique(df$study_site)) {
  # Subset the data for the study site
  subset_data <- subset(df, study_site == ss)

  # Remove rows with non-finite peat temperatures or FCO2 fluxes
  subset_data <- subset_data[is.finite(subset_data$peat_temp_5cm) & is.finite(subset_data$FCH4_EXP), ]

  # Check if there are enough data points to fit a curve
  if (length(subset_data$peat_temp_5cm) > 1) {
    # Fit the nonlinear model using nls
    model <- nls(FCH4_EXP ~ a + (b * peat_temp_5cm), data = subset_data,
                 start = list(a = 1, b = 0.1), algorithm = "port", control = nls.control(maxiter = 100))

    # Get coefficients
    coefs <- coef(model)

    # Calculate Q10 value
    Q10 <- exp(coefs['b'] * 10)

    # Create a sequence of temperatures for plotting the curve
    temp_seq <- seq(min(subset_data$peat_temp_5cm, na.rm = TRUE),
                    max(subset_data$peat_temp_5cm, na.rm = TRUE),
                    length.out = 100)

    # Predict FCO2 values using the fitted model
    FCH4_pred <- predict(model, newdata = data.frame(peat_temp_5cm = temp_seq))

    # Create a ggplot
    p <- ggplot(subset_data, aes(x = peat_temp_5cm, y = FCH4_EXP)) +
      geom_point() +
      geom_line(data = data.frame(peat_temp_5cm = temp_seq, FCH4_pred = FCH4_pred), aes(x = peat_temp_5cm, y = FCH4_pred), color = 'blue') +
      ggtitle(paste('FCH4-Q10 Curve for', ss, '(Q10 =', sprintf('%.2f', Q10), ')')) +
      xlab('Peat Temperature at 5cm (°C)') +
      ylab('FCH4 Flux (µmol m⁻² s⁻¹)') +
      theme_minimal()

    # Store the plot in the list
    plot_list[[ss]] <- p
  } else {
    warning(paste('Not enough data points to fit a curve for', ss))
  }
}

# Display the plots for each study site
for (ss_plot in plot_list) {
  print(ss_plot)
}
```

| FCH4-Q10 Values | Seedling Area | Seedling Removal Area |
|-----------------|---------------|-----------------------|
| PSLS            | 1.10          | 0.32                  |
| PSTS            | 0.29          | 0.45                  |
| PSW             | 0.79          | 0.16                  |

```{r}
exp_model <- function(temp, a, b) {
  a + (b * temp)
}

plot_list <- list()

# Loop over each study site to fit model and plot
for (ss in unique(df$study_site)) {
  # Subset the data for the study site
  subset_data <- subset(df, study_site == ss)

  # Remove rows with non-finite peat temperatures or FCO2 fluxes
  subset_data <- subset_data[is.finite(subset_data$peat_temp_5cm) & is.finite(subset_data$FCO2_EXP), ]

  # Check if there are enough data points to fit a curve
  if (length(subset_data$peat_temp_5cm) > 1) {
    # Fit the nonlinear model using nls
    model <- nls(FCO2_EXP ~ a + (b * peat_temp_5cm), data = subset_data,
                 start = list(a = 1, b = 0.1), algorithm = "port", control = nls.control(maxiter = 100))

    # Get coefficients
    coefs <- coef(model)

    # Calculate Q10 value
    Q10 <- exp(coefs['b'] * 10)

    # Create a sequence of temperatures for plotting the curve
    temp_seq <- seq(min(subset_data$peat_temp_5cm, na.rm = TRUE),
                    max(subset_data$peat_temp_5cm, na.rm = TRUE),
                    length.out = 100)

    # Predict FCO2 values using the fitted model
    FCO2_pred <- predict(model, newdata = data.frame(peat_temp_5cm = temp_seq))

    # Create a ggplot
    p <- ggplot(subset_data, aes(x = peat_temp_5cm, y = FCO2_EXP)) +
      geom_point() +
      geom_line(data = data.frame(peat_temp_5cm = temp_seq, FCO2_pred = FCO2_pred), aes(x = peat_temp_5cm, y = FCO2_pred), color = 'blue') +
      ggtitle(paste('FCO2-Q10 Curve for', ss, '(Q10 =', sprintf('%.2f', Q10), ')')) +
      xlab('Peat Temperature at 5cm (°C)') +
      ylab('FCO2 Flux (µmol m⁻² s⁻¹)') +
      theme_minimal()

    # Store the plot in the list
    plot_list[[ss]] <- p
  } else {
    warning(paste('Not enough data points to fit a curve for', ss))
  }
}

# Display the plots for each study site
for (ss_plot in plot_list) {
  print(ss_plot)
}

```

| FCO2-Q10 Values | Seedling Area | Seedling Removal Area |
|-----------------|---------------|-----------------------|
| PSLS            | 8.33          | 7.77                  |
| PSTS            | 14.59         | 8.13                  |
| PSW             | 1.71          | 5.97                  |

## PART3 - Mixed Effects Model

Refer to the paper \[Wildfire overrides hydrological controls on boreal peatland methane emissions\], model tests on seeing vegetation types and trts as fixed factor, collar ID as a random effect to take into account repeated measures.

```{r}
df1 <- df %>% 
  mutate(month = lubridate::month(date))
df1$collar_number <- substr(df1$label, 3, 3)
```

```{r}
# Load the required package
library(lme4)

# Fit the mixed effects models
M2 <- lmer(log(FCO2_EXP) ~ vegetation_type + trts + month + (1|collar_number), REML = FALSE, data = df1)
M3 <- lmer(log(FCO2_EXP) ~ vegetation_type * trts + month + (1|collar_number), REML = FALSE, data = df1)
M4 <- lmer(log(FCO2_EXP) ~ vegetation_type + month + (1|collar_number), REML = FALSE, data = df1)
M5 <- lmer(log(FCO2_EXP) ~ trts + month + (1|collar_number), REML = FALSE, data = df1)

# Perform the ANOVA comparison
anova(M2, M3)
anova(M2, M4)
anova(M2, M5)

# Check for linearity
plot(fitted(M2), resid(M2), xlab = "Fitted Values", ylab = "Residuals")
abline(h = 0, col = "red")
# Check for independence
acf(resid(M2), lag.max = 20, main = "ACF of Residuals")
# Check for homogenity
plot(fitted(M2), resid(M2), xlab = "Fitted Values", ylab = "Residuals")
abline(h = 0, col = "red")
# Check for normality
qqnorm(resid(M2))
qqline(resid(M2), col = "red")
shapiro.test(resid(M2))
```

```{r}
# Run anova on the model for significance of fixed effects
anova(M2)
# Run summary on the model for significance of random effects
summary(M2)
# the model suggests that trts and month are significant predictors of the log-transformed FCO2_EXP, with vegetation_type having a less significant effect. The low variance for collar_number suggests that the random effects structure is not explaining much of the variability in the data, which could be due to the grouping variable collar_number not having much influence on the outcome, or it could be that the variability is low between different collar_number groups.
```
